### **主题：指数函数 (exp) 的浮点数安全边界常量分析**

#### **核心概念**

在编程中对浮点数进行指数运算 `exp(x)` 时，输入值 `x` 如果过大或过小，会导致计算结果超出该浮点类型的表示范围，产生**溢出 (Overflow)** 或**下溢 (Underflow)** 错误。

以下常量被定义为 `exp(x)` 函数的安全输入边界，用于将输入值“钳位”(Clamp)在安全范围内，从而保证数值计算的稳定性。

-----

#### **一、 F32 (32位单精度浮点数) 边界**

##### **常量定义**

```c
#define MAX_EXP_F32 88.3762626647949f
#define MIN_EXP_F32 -88.3762626647949f
```

##### **分析**

* **`MAX_EXP_F32` (值为 `88.376...`)**

    * **用途**：`expf(x)` 函数的最大安全输入值。
    * **超出后果**：若输入 `x > 88.376...`，则 `expf(x)` 的结果将超出32位浮点数的最大表示范围，导致溢出，返回值变为**正无穷 (`Infinity`)**。
    * **数值来源**：这是一个**实践边界值 (Practical Bound)**，并非严格的数学推导 `ln(FLT_MAX)`。它常用于各大数学库的 `expf` 近似算法中，作为一个能确保在各种情况下都不会溢出的安全阈值。

* **`MIN_EXP_F32` (值为 `-88.376...`)**

    * **用途**：`expf(x)` 函数的最小安全输入值。
    * **超出后果**：若输入 `x < -88.376...`，则 `expf(x)` 的结果会因过小而无法用32位浮点数表示，导致下溢，返回值被舍入为**零 (`0.0`)**。
    * **数值来源**：`MAX_EXP_F32` 的相反数，同样是防止下溢的实践边界。

-----

#### **二、 F16 (16位半精度浮点数) 边界**

##### **常量定义**

```c
#define MAX_EXP_F16 __float2half(11.089866488461016f)
#define MIN_EXP_F16 __float2half(-9.704060527839234f)
```

*注：`__float2half()` 是一个内建函数，在编译时将32位浮点字面量转换为16位浮点类型。*

##### **分析**

与F32的实践边界不同，F16的边界是根据其数据范围**精确推导**的数学边界。

* **`MAX_EXP_F16` (值为 `11.089...`)**

    * **用途**：`exp(x)` 产生有效16位浮点数的最大输入值。
    * **超出后果**：结果溢出为正无穷。
    * **数值来源**：该值是16位浮点数能表示的最大值 `65504` 的自然对数。
      $$\ln(65504) \approx 11.089866$$

* **`MIN_EXP_F16` (值为 `-9.704...`)**

    * **用途**：`exp(x)` 产生非零16位浮点数的最小输入值。
    * **超出后果**：结果下溢为零。
    * **数值来源**：该值是16位浮点数能表示的最小规格化正数 $2^{-14}$ 的自然对数。
      $$\ln(2^{-14}) = -14 \times \ln(2) \approx -9.7040605$$

-----

#### **总结表**

| 常量名 | 关联数据类型 | 边界值 (约) | 边界类型 | 用途 |
| :--- | :--- | :--- | :--- |:--- |
| **`MAX_EXP_F32`** | `float` (32位) | `88.376` | 实践边界 | 防止 `expf(x)` 结果溢出为 `Infinity` |
| **`MIN_EXP_F32`** | `float` (32位) | `-88.376` | 实践边界 | 防止 `expf(x)` 结果下溢为 `0.0` |
| **`MAX_EXP_F16`** | `half` (16位) | `11.090` | 数学边界 | 防止 `exp(x)` 结果溢出为 `Infinity` |
| **`MIN_EXP_F16`** | `half` (16位) | `-9.704` | 数学边界 | 防止 `exp(x)` 结果下溢为 `0.0` |