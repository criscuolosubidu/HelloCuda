# ä¸ºä»€ä¹ˆMD struct åœ¨online softmaxä¸­ä¸ºä»€ä¹ˆéœ€è¦ __align__(8)å‘¢ï¼Ÿ

---

çœ‹åˆ°äº†è¿™ä¸ª MD struct çš„å®šä¹‰ã€‚è®©æˆ‘è§£é‡Šä¸€ä¸‹åœ¨ online softmax ä¸­ä¸ºä»€ä¹ˆéœ€è¦ `__align__(8)`ï¼š

## ä¸»è¦åŸå› ï¼š

### 1. **å†…å­˜è®¿é—®æ•ˆç‡**
- è¿™ä¸ªç»“æ„ä½“åŒ…å«ä¸¤ä¸ª `float`ï¼ˆæ¯ä¸ª 4 å­—èŠ‚ï¼‰ï¼Œæ€»å…± 8 å­—èŠ‚
- `__align__(8)` ç¡®ä¿ç»“æ„ä½“æŒ‰ 8 å­—èŠ‚è¾¹ç•Œå¯¹é½ï¼Œå¯ä»¥ä½¿ç”¨**å•ä¸ª 64-bit å†…å­˜äº‹åŠ¡**ä¸€æ¬¡æ€§è¯»å†™æ•´ä¸ªç»“æ„ä½“
- é¿å…äº†è·¨è¶Šç¼“å­˜è¡Œè¾¹ç•Œçš„è®¿é—®ï¼Œæé«˜äº†å†…å­˜å¸¦å®½åˆ©ç”¨ç‡

### 2. **å‘é‡åŒ–åŠ è½½/å­˜å‚¨**
- å¯¹é½åˆ° 8 å­—èŠ‚åï¼Œå¯ä»¥ä½¿ç”¨æ›´é«˜æ•ˆçš„æŒ‡ä»¤ï¼Œæ¯”å¦‚ï¼š
  ```cuda
  // å¯ä»¥ä½¿ç”¨ float2 æˆ– double ç±»å‹ä¸€æ¬¡æ€§åŠ è½½/å­˜å‚¨
  float2 md_vec = *reinterpret_cast<float2*>(&md_struct);
  ```

### 3. **Online Softmax ç®—æ³•ç‰¹æ€§**
åœ¨ online softmax ä¸­ï¼ŒMD ç»“æ„ä½“é€šå¸¸ç”¨äºï¼š
- `m`: ç»´æŠ¤å½“å‰çš„æœ€å¤§å€¼ï¼ˆmaxï¼‰
- `d`: ç»´æŠ¤å½’ä¸€åŒ–åˆ†æ¯ï¼ˆdenominator/sumï¼‰

è¿™ä¸¤ä¸ªå€¼éœ€è¦**é¢‘ç¹åœ°åŒæ—¶æ›´æ–°**ï¼Œä¾‹å¦‚ï¼š
```cuda
MD old_md = current_md;
MD new_md;
new_md.m = fmaxf(old_md.m, new_value);
new_md.d = old_md.d * expf(old_md.m - new_md.m) + expf(new_value - new_md.m);
```

### 4. **é¿å… Bank Conflicts**
åœ¨ shared memory ä¸­ï¼Œ8 å­—èŠ‚å¯¹é½å¯ä»¥å‡å°‘ bank conflictsï¼Œç‰¹åˆ«æ˜¯å½“å¤šä¸ªçº¿ç¨‹è®¿é—®ä¸åŒçš„ MD ç»“æ„ä½“æ—¶ã€‚

### 5. **æ½œåœ¨çš„åŸå­æ“ä½œæ”¯æŒ**
è™½ç„¶è¿™ä¸ªç®€å•çš„å®šä¹‰æ²¡æœ‰æ˜¾ç¤ºï¼Œä½†åœ¨æŸäº›å®ç°ä¸­ï¼Œå¯èƒ½éœ€è¦å¯¹æ•´ä¸ª MD ç»“æ„è¿›è¡ŒåŸå­æ›´æ–°ï¼Œ8 å­—èŠ‚å¯¹é½ä½¿å¾—å¯ä»¥ä½¿ç”¨ `atomicCAS` ç­‰åŸå­æ“ä½œã€‚

**æ€»ç»“**ï¼š`__align__(8)` ä¸»è¦æ˜¯ä¸ºäº†ç¡®ä¿å†…å­˜è®¿é—®çš„é«˜æ•ˆæ€§ï¼Œç‰¹åˆ«æ˜¯åœ¨ GPU ä¸Šè¿›è¡Œé¢‘ç¹çš„è¯»å†™æ“ä½œæ—¶ï¼Œå¯¹é½å¯ä»¥æ˜¾è‘—æå‡æ€§èƒ½ã€‚

```plaintext
  // å¯ä»¥ä½¿ç”¨ float2 æˆ– double ç±»å‹ä¸€æ¬¡æ€§åŠ è½½/å­˜å‚¨
  float2 md_vec = *reinterpret_cast<float2*>(&md_struct);
```

```plaintext
MD old_md = current_md;
MD new_md;
new_md.m = fmaxf(old_md.m, new_value);
new_md.d = old_md.d * expf(old_md.m - new_md.m) + expf(new_value - new_md.m);
```

---

**User**

å¦‚æœä¸æ˜¾ç¤ºæ·»åŠ alignä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

---

**Cursor**

å¥½é—®é¢˜ï¼è®©æˆ‘è¯¦ç»†è§£é‡Šå¦‚æœä¸æ˜¾å¼æ·»åŠ  `__align__(8)` ä¼šå‘ç”Ÿä»€ä¹ˆï¼š

## é»˜è®¤è¡Œä¸ºï¼ˆæ—  `__align__(8)`ï¼‰ï¼š

```cuda
struct MD {
    float m;  // 4 bytes
    float d;  // 4 bytes
};
```

### 1. **é»˜è®¤å¯¹é½æ–¹å¼**
- ç¼–è¯‘å™¨ä¼šæŒ‰ç…§**æœ€å¤§æˆå‘˜çš„å¤§å°**å¯¹é½ï¼Œå³ `alignof(float) = 4` å­—èŠ‚
- ç»“æ„ä½“å¤§å°ä»ç„¶æ˜¯ 8 å­—èŠ‚ï¼Œä½†**å¯¹é½è¾¹ç•Œæ˜¯ 4 å­—èŠ‚**

### 2. **æ½œåœ¨é—®é¢˜**

#### é—®é¢˜ 1ï¼šæ— æ³•ä¿è¯ 8 å­—èŠ‚è¾¹ç•Œå¯¹é½
```cuda
MD data[100];
// data[0] å¯èƒ½åœ¨åœ°å€ 0x1000 (8å­—èŠ‚å¯¹é½)
// data[1] å¯èƒ½åœ¨åœ°å€ 0x1008 (8å­—èŠ‚å¯¹é½)
// ä½†ä¹Ÿå¯èƒ½ï¼š
// data[0] åœ¨åœ°å€ 0x1004 (ä»…4å­—èŠ‚å¯¹é½!) âŒ
// data[1] åœ¨åœ°å€ 0x100c (ä»…4å­—èŠ‚å¯¹é½!) âŒ
```

#### é—®é¢˜ 2ï¼šå‘é‡åŒ–åŠ è½½å¯èƒ½å´©æºƒæˆ–æ€§èƒ½ä¸‹é™
```cuda
// å¦‚æœåœ°å€ä¸æ˜¯8å­—èŠ‚å¯¹é½ï¼Œè¿™ä¸ªæ“ä½œå¯èƒ½ï¼š
float2 md_vec = *reinterpret_cast<float2*>(&md_struct);
// - è§¦å‘ misaligned access (åœ¨æŸäº›æ¶æ„ä¸Šä¼šå´©æºƒ)
// - éœ€è¦ä¸¤æ¬¡ 4 å­—èŠ‚åŠ è½½è€Œä¸æ˜¯ä¸€æ¬¡ 8 å­—èŠ‚åŠ è½½
```

#### é—®é¢˜ 3ï¼šæ€§èƒ½å·®å¼‚ç¤ºä¾‹
```cuda
// æœ‰ __align__(8)ï¼š
// å•æ¬¡ 64-bit åŠ è½½æŒ‡ä»¤: LD.E.64
float2 val = *reinterpret_cast<float2*>(&aligned_md);

// æ—  __align__(8) ä¸”åœ°å€ä¸å¯¹é½ï¼š
// å¯èƒ½éœ€è¦ä¸¤æ¬¡ 32-bit åŠ è½½: LD.E.32 Ã— 2
float m = unaligned_md.m;  // ç¬¬ä¸€æ¬¡åŠ è½½
float d = unaligned_md.d;  // ç¬¬äºŒæ¬¡åŠ è½½
```

### 3. **å®é™…å¯¹æ¯”**

è®©æˆ‘åˆ›å»ºä¸€ä¸ªæµ‹è¯•æ¥å±•ç¤ºå·®å¼‚ï¼š

```cuda
#include <iostream>

struct MD_Unaligned {
    float m;
    float d;
};

struct __align__(8) MD_Aligned {
    float m;
    float d;
};

int main() {
    std::cout << "MD_Unaligned:" << std::endl;
    std::cout << "  sizeof: " << sizeof(MD_Unaligned) << std::endl;
    std::cout << "  alignof: " << alignof(MD_Unaligned) << std::endl;
    
    std::cout << "\nMD_Aligned:" << std::endl;
    std::cout << "  sizeof: " << sizeof(MD_Aligned) << std::endl;
    std::cout << "  alignof: " << alignof(MD_Aligned) << std::endl;
    
    // æ•°ç»„ä¸­çš„åœ°å€
    MD_Unaligned arr1[3];
    MD_Aligned arr2[3];
    
    std::cout << "\næ•°ç»„å…ƒç´ åœ°å€å·®å¼‚:" << std::endl;
    for(int i = 0; i < 3; i++) {
        std::cout << "arr1[" << i << "]: " << (void*)&arr1[i] 
                  << " (8å­—èŠ‚å¯¹é½: " << (((size_t)&arr1[i] % 8) == 0 ? "æ˜¯" : "å¦") << ")" << std::endl;
    }
    
    for(int i = 0; i < 3; i++) {
        std::cout << "arr2[" << i << "]: " << (void*)&arr2[i] 
                  << " (8å­—èŠ‚å¯¹é½: " << (((size_t)&arr2[i] % 8) == 0 ? "æ˜¯" : "å¦") << ")" << std::endl;
    }
    
    return 0;
}
```

### 4. **æ€§èƒ½å½±å“æ€»ç»“**

| æ–¹é¢ | æ—  `__align__(8)` | æœ‰ `__align__(8)` |
|------|------------------|------------------|
| å¯¹é½è¾¹ç•Œ | 4 å­—èŠ‚ | 8 å­—èŠ‚ |
| å‘é‡åŒ–åŠ è½½ | ä¸ä¿è¯å¯ç”¨ | å¯ä»¥å®‰å…¨ä½¿ç”¨ `float2` |
| å†…å­˜äº‹åŠ¡ | å¯èƒ½éœ€è¦ 2 æ¬¡ | 1 æ¬¡ 8 å­—èŠ‚äº‹åŠ¡ |
| æ€§èƒ½ | è¾ƒæ…¢ï¼ˆå°¤å…¶åœ¨æ•°ç»„ä¸­ï¼‰ | æ›´å¿« |
| Shared Memory | å¯èƒ½æœ‰ bank conflicts | ä¼˜åŒ–çš„è®¿é—®æ¨¡å¼ |

### 5. **Online Softmax ä¸­çš„å½±å“**

åœ¨ online softmax ä¸­ï¼Œé€šå¸¸ä¼šæœ‰ï¼š
```cuda
__shared__ MD shared_md[THREAD_COUNT];
shared_md[tid].m = ...;
shared_md[tid].d = ...;
```

**æ²¡æœ‰å¯¹é½**ï¼šæ¯ä¸ªçº¿ç¨‹çš„è®¿é—®å¯èƒ½ä¸é«˜æ•ˆï¼Œwarp å†…çš„å†…å­˜åˆå¹¶å¯èƒ½ä¸ç†æƒ³

**æœ‰å¯¹é½**ï¼šä¿è¯é«˜æ•ˆçš„å†…å­˜è®¿é—®æ¨¡å¼ï¼Œç‰¹åˆ«æ˜¯åœ¨ä½¿ç”¨å‘é‡åŒ–æŒ‡ä»¤æ—¶

## ç»“è®º
ä¸åŠ  `__align__(8)` ä»£ç ä»ç„¶èƒ½è¿è¡Œï¼Œä½†ä¼š**æŸå¤±æ€§èƒ½**ã€‚åœ¨é«˜æ€§èƒ½è®¡ç®—åœºæ™¯ï¼ˆå¦‚ online softmaxï¼‰ä¸­ï¼Œè¿™ç§æ€§èƒ½å·®å¼‚æ˜¯å¾ˆé‡è¦çš„ä¼˜åŒ–ç‚¹ã€‚

```plaintext
struct MD {
    float m;  // 4 bytes
    float d;  // 4 bytes
};
```

```plaintext
MD data[100];
// data[0] å¯èƒ½åœ¨åœ°å€ 0x1000 (8å­—èŠ‚å¯¹é½)
// data[1] å¯èƒ½åœ¨åœ°å€ 0x1008 (8å­—èŠ‚å¯¹é½)
// ä½†ä¹Ÿå¯èƒ½ï¼š
// data[0] åœ¨åœ°å€ 0x1004 (ä»…4å­—èŠ‚å¯¹é½!) âŒ
// data[1] åœ¨åœ°å€ 0x100c (ä»…4å­—èŠ‚å¯¹é½!) âŒ
```

```plaintext
// å¦‚æœåœ°å€ä¸æ˜¯8å­—èŠ‚å¯¹é½ï¼Œè¿™ä¸ªæ“ä½œå¯èƒ½ï¼š
float2 md_vec = *reinterpret_cast<float2*>(&md_struct);
// - è§¦å‘ misaligned access (åœ¨æŸäº›æ¶æ„ä¸Šä¼šå´©æºƒ)
// - éœ€è¦ä¸¤æ¬¡ 4 å­—èŠ‚åŠ è½½è€Œä¸æ˜¯ä¸€æ¬¡ 8 å­—èŠ‚åŠ è½½
```

```plaintext
// æœ‰ __align__(8)ï¼š
// å•æ¬¡ 64-bit åŠ è½½æŒ‡ä»¤: LD.E.64
float2 val = *reinterpret_cast<float2*>(&aligned_md);

// æ—  __align__(8) ä¸”åœ°å€ä¸å¯¹é½ï¼š
// å¯èƒ½éœ€è¦ä¸¤æ¬¡ 32-bit åŠ è½½: LD.E.32 Ã— 2
float m = unaligned_md.m;  // ç¬¬ä¸€æ¬¡åŠ è½½
float d = unaligned_md.d;  // ç¬¬äºŒæ¬¡åŠ è½½
```

```cpp
#include <iostream>

struct MD_Unaligned {
    float m;
    float d;
};

struct __align__(8) MD_Aligned {
    float m;
    float d;
};

int main() {
    std::cout << "MD_Unaligned:" << std::endl;
    std::cout << "  sizeof: " << sizeof(MD_Unaligned) << std::endl;
    std::cout << "  alignof: " << alignof(MD_Unaligned) << std::endl;
    
    std::cout << "\nMD_Aligned:" << std::endl;
    std::cout << "  sizeof: " << sizeof(MD_Aligned) << std::endl;
    std::cout << "  alignof: " << alignof(MD_Aligned) << std::endl;
    
    // æ•°ç»„ä¸­çš„åœ°å€
    MD_Unaligned arr1[3];
    MD_Aligned arr2[3];
    
    std::cout << "\næ•°ç»„å…ƒç´ åœ°å€å·®å¼‚:" << std::endl;
    for(int i = 0; i < 3; i++) {
        std::cout << "arr1[" << i << "]: " << (void*)&arr1[i] 
                  << " (8å­—èŠ‚å¯¹é½: " << (((size_t)&arr1[i] % 8) == 0 ? "æ˜¯" : "å¦") << ")" << std::endl;
    }
    
    for(int i = 0; i < 3; i++) {
        std::cout << "arr2[" << i << "]: " << (void*)&arr2[i] 
                  << " (8å­—èŠ‚å¯¹é½: " << (((size_t)&arr2[i] % 8) == 0 ? "æ˜¯" : "å¦") << ")" << std::endl;
    }
    
    return 0;
}
```

```plaintext
__shared__ MD shared_md[THREAD_COUNT];
shared_md[tid].m = ...;
shared_md[tid].d = ...;
```

---

**User**

æˆ‘è¿˜æ˜¯ä¸å¤ªç†è§£ï¼Œå­—èŠ‚å¯¹é½æ˜¯å•¥æ„æ€ï¼Ÿ

---

**Cursor**

å¥½çš„ï¼è®©æˆ‘ç”¨æ›´é€šä¿—æ˜“æ‡‚çš„æ–¹å¼è§£é‡Š**å­—èŠ‚å¯¹é½**çš„æ¦‚å¿µã€‚

## ä»€ä¹ˆæ˜¯å­—èŠ‚å¯¹é½ï¼Ÿ

æƒ³è±¡ä¸€ä¸‹ï¼Œå†…å­˜å°±åƒä¸€æ’**åœè½¦ä½**ï¼š

### ğŸ“¦ å†…å­˜åœ°å€ç¤ºæ„å›¾

```
åœ°å€:  0x00  0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0A  0x0B
       [  ]  [  ]  [  ]  [  ]  [  ]  [  ]  [  ]  [  ]  [  ]  [  ]  [  ]  [  ]
```

æ¯ä¸ªæ ¼å­ä»£è¡¨ 1 å­—èŠ‚çš„å†…å­˜ç©ºé—´ã€‚

### 1. **å¯¹é½çš„å«ä¹‰**

**å¯¹é½** = æ•°æ®çš„èµ·å§‹åœ°å€å¿…é¡»æ˜¯æŸä¸ªæ•°å­—çš„**å€æ•°**

- **4 å­—èŠ‚å¯¹é½**ï¼šèµ·å§‹åœ°å€å¿…é¡»æ˜¯ 4 çš„å€æ•°ï¼ˆ0, 4, 8, 12, ...ï¼‰
- **8 å­—èŠ‚å¯¹é½**ï¼šèµ·å§‹åœ°å€å¿…é¡»æ˜¯ 8 çš„å€æ•°ï¼ˆ0, 8, 16, 24, ...ï¼‰

### 2. **å…·ä½“ä¾‹å­**

#### åœºæ™¯ 1ï¼šå­˜å‚¨ä¸€ä¸ª `float`ï¼ˆ4 å­—èŠ‚ï¼‰

**4 å­—èŠ‚å¯¹é½** âœ… æ­£ç¡®ï¼š
```
åœ°å€:  0x00  0x01  0x02  0x03  0x04  0x05  0x06  0x07
       [====float====]         [====float====]
       â†‘èµ·å§‹äº0ï¼ˆ4çš„å€æ•°ï¼‰      â†‘èµ·å§‹äº4ï¼ˆ4çš„å€æ•°ï¼‰
```

**æœªå¯¹é½** âŒ ä¸å¥½ï¼š
```
åœ°å€:  0x00  0x01  0x02  0x03  0x04  0x05  0x06  0x07
       [  ]  [====float====]
             â†‘èµ·å§‹äº1ï¼ˆä¸æ˜¯4çš„å€æ•°ï¼‰
```

#### åœºæ™¯ 2ï¼šå­˜å‚¨ MD ç»“æ„ä½“ï¼ˆ8 å­—èŠ‚ï¼‰

**8 å­—èŠ‚å¯¹é½** âœ… æœ€ä¼˜ï¼š
```
åœ°å€:  0x00  0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0A  0x0B
       [====m float===][====d float===]         [====m float===][====d float===]
       |<------- MD ç»“æ„ä½“ 8å­—èŠ‚ ------>|        |<------- MD ç»“æ„ä½“ ------>|
       â†‘ èµ·å§‹äº 0x00 (8çš„å€æ•°)                    â†‘ èµ·å§‹äº 0x08 (8çš„å€æ•°)
```

**ä»… 4 å­—èŠ‚å¯¹é½** âš ï¸ æ¬¡ä¼˜ï¼š
```
åœ°å€:  0x00  0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0A  0x0B
       [====m float===][====d float===][====m float===][====d float===]
       |<------ MD ------>|            |<------ MD ------>|
       â†‘ 0x00 (8çš„å€æ•°)âœ…               â†‘ 0x04 (ä¸æ˜¯8çš„å€æ•°)âŒ
```

### 3. **ä¸ºä»€ä¹ˆå¯¹é½å¾ˆé‡è¦ï¼Ÿ**

#### åŸå› ï¼šCPU/GPU è¯»å–å†…å­˜çš„æ–¹å¼

**å…³é”®ç‚¹**ï¼šCPU/GPU ä¸€æ¬¡è¯»å–å†…å­˜æ˜¯æŒ‰"å—"è¯»çš„ï¼Œä¸æ˜¯æŒ‰å­—èŠ‚è¯»çš„ï¼

```plaintext
åœ°å€:  0x00  0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0A  0x0B
       [  ]  [  ]  [  ]  [  ]  [  ]  [  ]  [  ]  [  ]  [  ]  [  ]  [  ]  [  ]
```

```plaintext
åœ°å€:  0x00  0x01  0x02  0x03  0x04  0x05  0x06  0x07
       [====float====]         [====float====]
       â†‘èµ·å§‹äº0ï¼ˆ4çš„å€æ•°ï¼‰      â†‘èµ·å§‹äº4ï¼ˆ4çš„å€æ•°ï¼‰
```

```plaintext
åœ°å€:  0x00  0x01  0x02  0x03  0x04  0x05  0x06  0x07
       [  ]  [====float====]
             â†‘èµ·å§‹äº1ï¼ˆä¸æ˜¯4çš„å€æ•°ï¼‰
```

```plaintext
åœ°å€:  0x00  0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0A  0x0B
       [====m float===][====d float===]         [====m float===][====d float===]
       |<------- MD ç»“æ„ä½“ 8å­—èŠ‚ ------>|        |<------- MD ç»“æ„ä½“ ------>|
       â†‘ èµ·å§‹äº 0x00 (8çš„å€æ•°)                    â†‘ èµ·å§‹äº 0x08 (8çš„å€æ•°)
```

```plaintext
åœ°å€:  0x00  0x01  0x02  0x03  0x04  0x05  0x06  0x07  0x08  0x09  0x0A  0x0B
       [====m float===][====d float===][====m float===][====d float===]
       |<------ MD ------>|            |<------ MD ------>|
       â†‘ 0x00 (8çš„å€æ•°)âœ…               â†‘ 0x04 (ä¸æ˜¯8çš„å€æ•°)âŒ
```

```
CPU/GPU çš„å†…å­˜æ€»çº¿å°±åƒä¸€è¾†"å…¬äº¤è½¦"ï¼š
- 32ä½ç³»ç»Ÿï¼šæ¯æ¬¡è¿ 4 å­—èŠ‚ï¼ˆä¸€è¶Ÿè½¦æ‹‰4ä¸ªä¹˜å®¢ï¼‰
- 64ä½ç³»ç»Ÿï¼šæ¯æ¬¡è¿ 8 å­—èŠ‚ï¼ˆä¸€è¶Ÿè½¦æ‹‰8ä¸ªä¹˜å®¢ï¼‰
```

#### ç¤ºä¾‹ Aï¼š8å­—èŠ‚å¯¹é½ - **ä¸€æ¬¡æå®š** âœ…
```
å†…å­˜:  [0][1][2][3][4][5][6][7][8][9][A][B]
       [========MDç»“æ„ä½“========]
       
ä¸€æ¬¡è¯»å– â†“ï¼ˆ8å­—èŠ‚ï¼Œä¸€è¶Ÿå…¬äº¤è½¦ï¼‰
       æ‹¿åˆ°å®Œæ•´çš„ MDï¼
```

#### ç¤ºä¾‹ Bï¼šæœªå¯¹é½ - **éœ€è¦ä¸¤æ¬¡** âŒ
```
å†…å­˜:  [0][1][2][3][4][5][6][7][8][9][A][B]
           [========MDç»“æ„ä½“========]
           
ç¬¬ä¸€æ¬¡è¯»å– â†“ï¼ˆæ‹¿åˆ°åœ°å€0-7ï¼‰
       [0][1][2][3][4][5][6][7]
           â””â”€åªæ‹¿åˆ° m å’Œä¸€åŠçš„ d
           
ç¬¬äºŒæ¬¡è¯»å– â†“ï¼ˆæ‹¿åˆ°åœ°å€8-15ï¼‰
                       [8][9][A][B]...
                        â””â”€æ‹¿åˆ°å¦ä¸€åŠ d
                        
ç„¶å CPU è¿˜è¦æŠŠä¸¤æ¬¡çš„ç»“æœ"æ‹¼æ¥"èµ·æ¥ï¼
```

### 4. **ä»£ç æ¼”ç¤º**

è®©æˆ‘åˆ›å»ºä¸€ä¸ªç›´è§‚çš„ç¤ºä¾‹ï¼š

```plaintext
CPU/GPU çš„å†…å­˜æ€»çº¿å°±åƒä¸€è¾†"å…¬äº¤è½¦"ï¼š
- 32ä½ç³»ç»Ÿï¼šæ¯æ¬¡è¿ 4 å­—èŠ‚ï¼ˆä¸€è¶Ÿè½¦æ‹‰4ä¸ªä¹˜å®¢ï¼‰
- 64ä½ç³»ç»Ÿï¼šæ¯æ¬¡è¿ 8 å­—èŠ‚ï¼ˆä¸€è¶Ÿè½¦æ‹‰8ä¸ªä¹˜å®¢ï¼‰
```

```plaintext
å†…å­˜:  [0][1][2][3][4][5][6][7][8][9][A][B]
       [========MDç»“æ„ä½“========]
       
ä¸€æ¬¡è¯»å– â†“ï¼ˆ8å­—èŠ‚ï¼Œä¸€è¶Ÿå…¬äº¤è½¦ï¼‰
       æ‹¿åˆ°å®Œæ•´çš„ MDï¼
```

```plaintext
å†…å­˜:  [0][1][2][3][4][5][6][7][8][9][A][B]
           [========MDç»“æ„ä½“========]
           
ç¬¬ä¸€æ¬¡è¯»å– â†“ï¼ˆæ‹¿åˆ°åœ°å€0-7ï¼‰
       [0][1][2][3][4][5][6][7]
           â””â”€åªæ‹¿åˆ° m å’Œä¸€åŠçš„ d
           
ç¬¬äºŒæ¬¡è¯»å– â†“ï¼ˆæ‹¿åˆ°åœ°å€8-15ï¼‰
                       [8][9][A][B]...
                        â””â”€æ‹¿åˆ°å¦ä¸€åŠ d
                        
ç„¶å CPU è¿˜è¦æŠŠä¸¤æ¬¡çš„ç»“æœ"æ‹¼æ¥"èµ·æ¥ï¼
```

```plaintext

#### ç¤ºä¾‹ Aï¼š8å­—èŠ‚å¯¹é½ - **ä¸€æ¬¡æå®š** âœ…
```

```plaintext

#### ç¤ºä¾‹ Bï¼šæœªå¯¹é½ - **éœ€è¦ä¸¤æ¬¡** âŒ
```

